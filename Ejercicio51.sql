CREATE TABLE PROFESOR(
    DNI VARCHAR(9) NOT NULL,
    NOMBRE VARCHAR(40) NOT NULL,
    AP1 VARCHAR(40) NOT NULL,
    AP2 VARCHAR(40),
    DIRECCION VARCHAR(30) NOT NULL,
    CUENTA VARCHAR(10) NOT NULL,
    TELEFONO NUMBER(9) NOT NULL,

    CONSTRAINT PK_PROFESOR PRIMARY KEY(DNI)
);

CREATE TABLE CICLO_FORM(
    COD_CICLO NUMBER(4) NOT NULL,
    NOMBRE VARCHAR(30) NOT NULL,
    TIPO VARCHAR(30) NOT NULL,
    -- P · COD_CICLO
    CONSTRAINT PK_CICLO_FORM PRIMARY KEY(COD_CICLO)
);

CREATE TABLE ASIGNATURA(
    COD_ASIG NUMBER(4) NOT NULL,
    NOMBRE VARCHAR(30) NOT NULL,
    NUM_HORAS NUMBER(2) NOT NULL,
   
    CONSTRAINT PK_ASIGNATURA PRIMARY KEY(COD_ASIG),
   
    DNI_PROFESOR VARCHAR(9) NOT NULL,
    CONSTRAINT FK_PROFESOR FOREIGN KEY(DNI_PROFESOR) REFERENCES PROFESOR(DNI),
   
    COD_CICLO NUMBER(4) NOT NULL,
    CONSTRAINT FK_CICLO_FORM FOREIGN KEY(COD_CICLO) REFERENCES CICLO_FORM(COD_CICLO)
);

CREATE TABLE IDIOMA(
    COD_IDIOMA NUMBER(4) NOT NULL,
    DESCRIPCION VARCHAR(20) NOT NULL,
    
    CONSTRAINT PK_IDIOMA PRIMARY KEY(COD_IDIOMA)
);

CREATE TABLE ALUMNO(
    DNI VARCHAR(9) NOT NULL,
    NOMBRE VARCHAR(40) NOT NULL,
    AP1 VARCHAR(40) NOT NULL,
    AP2 VARCHAR(40),
    DIRECCION VARCHAR(30) NOT NULL,
    EMAIL VARCHAR(30) NOT NULL,
    TELEFONO NUMBER(9) NOT NULL,
  
    CONSTRAINT PK_ALUMNO PRIMARY KEY(DNI),
    
    COD_IDIOMA NUMBER(4) NULL,
    CONSTRAINT FK_IDIOMA FOREIGN KEY(COD_IDIOMA) REFERENCES IDIOMA(COD_IDIOMA)
);

CREATE TABLE MATRICULA(
  
    DNI VARCHAR(9) NOT NULL,
    
    COD_ASIG NUMBER(4) NOT NULL,
    
    CONSTRAINT PK_MATRICULA PRIMARY KEY(DNI, COD_ASIG),
    CONSTRAINT FK_ALUMNO FOREIGN KEY(DNI) REFERENCES ALUMNO(DNI),
    CONSTRAINT FK_ASIGNATURA FOREIGN KEY(COD_ASIG) REFERENCES ASIGNATURA(COD_ASIG)
);

CREATE TABLE IDIOMAS_PROF(
    
    COD_IDIOMA NUMBER(4) NOT NULL,
   
    DNI VARCHAR(9) NOT NULL,

    CONSTRAINT PK_IDIOMAS_PROF PRIMARY KEY(COD_IDIOMA, DNI)
);

CREATE TABLE DATOS_PERSONALES(
    DNI VARCHAR(9),
    NOMBRE VARCHAR(40) NOT NULL,
    AP1 VARCHAR(40) NOT NULL,
    AP2 VARCHAR(40),
    DIRECCION VARCHAR(30) NOT NULL,
    TELEFONO NUMBER(9) NOT NULL,
    TIPO VARCHAR(20) NOT NULL,
    CONSTRAINT PK_DATOS_PERSONALES PRIMARY KEY(DNI),
    CONSTRAINT CK_CANTIDAD CHECK(TIPO IN('PROFESOR', 'ALUMNO'))
);

ALTER TABLE PROFESOR DROP(NOMBRE, AP1, AP2, DIRECCION, TELEFONO);
ALTER TABLE ALUMNO DROP(NOMBRE, AP1, AP2, DIRECCION, TELEFONO);



ALTER TABLE PROFESOR MODIFY CUENTA VARCHAR(40);
ALTER TABLE ASIGNATURA MODIFY NUM_HORAS NUMBER(3);

INSERT INTO DATOS_PERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('78654896M','MARTA','MARTIN','RODRIGUEZ','C/Miravilla',983652148,'ALUMNO');
INSERT INTO DATOS_PERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('44103779F','JESUS','LOPEZ','ANTON','C/Lopez Gomez',654987123,'PROFESOR');
INSERT INTO DATOS_PERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('11526987G','PEDRO','DIAZ','HERNANDEZ','C/Transicion',698741236,'ALUMNO');
INSERT INTO DATOS_PERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('89621477A','LUIS','VILA','GOMEZ','C/Cardenal Torquemada',654710236,'PROFESOR');
INSERT INTO DATOS_PERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('45986321N','ANDREA','RIVAS','ALONSO','C/Salud',622254789,'ALUMNO');
INSERT INTO DATOS_PERSONALES(DNI, NOMBRE, AP1, AP2, DIRECCION, TELEFONO, TIPO) VALUES('71056984D','MIRIAM','ALONSO','BERODAS','C/Paseo Zorrilla',645897123,'ALUMNO');

INSERT INTO CICLO_FORM(COD_CICLO, NOMBRE, TIPO) VALUES(1565, 'DAM', 'GRADO SUPERIOR');
INSERT INTO CICLO_FORM(COD_CICLO, NOMBRE, TIPO) VALUES(2598, 'SMR', 'GRADO MEDIO');
INSERT INTO CICLO_FORM(COD_CICLO, NOMBRE, TIPO) VALUES(1489, 'ARI', 'GRADO SUPERIOR');

INSERT INTO PROFESOR(DNI, CUENTA) VALUES('44103779F', 'ES2002399348396092013170');
INSERT INTO PROFESOR(DNI, CUENTA) VALUES('89621477A', 'ES8501865417580989668301');

INSERT INTO ALUMNO(DNI, EMAIL, COD_IDIOMA) VALUES('71654896M', 'marta.mr@gmail.com', 20);
INSERT INTO ALUMNO(DNI, EMAIL, COD_IDIOMA) VALUES('11526987G', 'pedro.dh@gmail.com', 20);
INSERT INTO ALUMNO(DNI, EMAIL, COD_IDIOMA) VALUES('45986321N', 'andrea.ra@gmail.com', 30);
INSERT INTO ALUMNO(DNI, EMAIL, COD_IDIOMA) VALUES('71056984D', 'miriam.ab@gmail.com', 30);

INSERT INTO IDIOMA(COD_IDIOMA, DESCRIPCION) VALUES(20, 'Inglés');
INSERT INTO IDIOMA(COD_IDIOMA, DESCRIPCION) VALUES(30, 'Español');

INSERT INTO ASIGNATURA(COD_ASIG, NOMBRE, NUM_HORAS, DNI_PROFESOR, COD_CICLO) VALUES(seqAsignatura.CURRVAL,'Empresa',128,'44103779F',1565);
INSERT INTO ASIGNATURA(COD_ASIG, NOMBRE, NUM_HORAS, DNI_PROFESOR, COD_CICLO) VALUES(seqAsignatura.NEXTVAL,'Informática Industrial',269,'44103779F',1565);
INSERT INTO ASIGNATURA(COD_ASIG, NOMBRE, NUM_HORAS, DNI_PROFESOR, COD_CICLO) VALUES(seqAsignatura.NEXTVAL,'Aplicaciones Web',200,'89621477A',2598);
INSERT INTO ASIGNATURA(COD_ASIG, NOMBRE, NUM_HORAS, DNI_PROFESOR, COD_CICLO) VALUES(seqAsignatura.NEXTVAL,'Bases de datos',170,'89621477A',1489);
INSERT INTO ASIGNATURA(COD_ASIG, NOMBRE, NUM_HORAS, DNI_PROFESOR, COD_CICLO) VALUES(seqAsignatura.NEXTVAL,'Programación',225,'89621477A',2598);

INSERT INTO IDIOMAS_PROF(COD_IDIOMA, DNI) VALUES(30, '44103779F');
INSERT INTO IDIOMAS_PROF(COD_IDIOMA, DNI) VALUES(20, '89621477A');
INSERT INTO IDIOMAS_PROF(COD_IDIOMA, DNI) VALUES(30, '89621477A');

INSERT INTO MATRICULA(DNI, COD_ASIG) VALUES('71654896M',1);
INSERT INTO MATRICULA(DNI, COD_ASIG) VALUES('11526987G',2);
INSERT INTO MATRICULA(DNI, COD_ASIG) VALUES('45986321N',3);
INSERT INTO MATRICULA(DNI, COD_ASIG) VALUES('71056984D',4);
INSERT INTO MATRICULA(DNI, COD_ASIG) VALUES('71654896M',5);
INSERT INTO MATRICULA(DNI, COD_ASIG) VALUES('11526987G',1);



DELETE FROM ASIGNATURA; 


CREATE SEQUENCE seqAsignatura
START WITH 1 INCREMENT BY 1
MAXVALUE 999 NOCYCLE;

ALTER SEQUENCE seqAsignatura INCREMENT BY 1;

DELETE FROM MATRICULA;



--A
SELECT NOMBRE 
FROM CICLO_FORM
WHERE TIPO = ('GRADO SUPERIOR');

--B
SELECT NOMBRE, AP1, AP2, DIRECCION
FROM DATOS_PERSONALES
WHERE TIPO = 'PROFESOR';

--C
SELECT NOMBRE
FROM ASIGNATURA
WHERE NUM_HORAS BETWEEN 150 AND 250;

--D
SELECT DP.NOMBRE, P.CUENTA
FROM DATOS_PERSONALES DP
JOIN PROFESOR P ON DP.DNI = P.DNI;

--E
SELECT DNI
FROM MATRICULA
WHERE COD_ASIG =(3);

--F
SELECT DNI
FROM IDIOMAS_PROF
WHERE COD_IDIOMA =(30);

--G
SELECT NOMBRE
FROM ASIGNATURA
WHERE DNI_PROFESOR LIKE('89621477%');

--H
SELECT DNI
FROM DATOS_PERSONALES
WHERE NOMBRE = ('ANDREA')
OR NOMBRE = ('LUIS');
